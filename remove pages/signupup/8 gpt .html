<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>8 gpt</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;700;800&display=swap" rel="stylesheet">

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Tajawal', 'ui-sans-serif', 'system-ui'] },
          boxShadow: {
            ink: '6px 6px 0 #000',
            inkSm: '3px 3px 0 #000',
          }
        }
      }
    }
  </script>

  <style>
    :root{
      --paper:#fbf8f1;
      --ink:#0a0a0a;
      --ink2:#111;
      --wash:rgba(0,0,0,.06);
      --wash2:rgba(0,0,0,.12);
      --dot:rgba(0,0,0,.10);
      --dot2:rgba(0,0,0,.06);
      --scratch:rgba(0,0,0,.05);
    }

    html,body{ height:100%; }
    body{
      font-family: Tajawal, system-ui, -apple-system, Segoe UI, sans-serif;
      background: var(--paper);
      color: var(--ink);
      overflow-x:hidden;
    }

    /* Paper texture + halftone */
    .paper{
      position:relative;
      isolation:isolate;
    }
    .paper::before{
      content:"";
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:-1;
      background:
        radial-gradient(circle at 1px 1px, var(--dot) 1px, transparent 1.5px) 0 0/18px 18px,
        radial-gradient(circle at 2px 2px, var(--dot2) 1px, transparent 2px) 6px 10px/22px 22px,
        repeating-linear-gradient(0deg, rgba(0,0,0,.02) 0 1px, transparent 1px 6px),
        repeating-linear-gradient(90deg, rgba(0,0,0,.015) 0 1px, transparent 1px 7px);
      mix-blend-mode:multiply;
      opacity:.85;
      filter: contrast(1.05);
    }
    .paper::after{
      content:"";
      position:fixed;
      inset:-30px;
      pointer-events:none;
      z-index:-1;
      background:
        radial-gradient(1200px 700px at 30% 10%, rgba(0,0,0,.06), transparent 60%),
        radial-gradient(900px 600px at 80% 30%, rgba(0,0,0,.05), transparent 60%),
        radial-gradient(900px 700px at 40% 90%, rgba(0,0,0,.04), transparent 60%),
        repeating-linear-gradient(135deg, transparent 0 10px, rgba(0,0,0,.012) 10px 11px);
      opacity:.9;
    }

    /* Manga panel */
    .panel{
      background: rgba(255,255,255,.55);
      border:3px solid #000;
      box-shadow: var(--shadow, 6px 6px 0 #000);
      border-radius: 18px;
      position:relative;
    }
    .panel::after{
      content:"";
      position:absolute;
      inset:10px;
      border:1px dashed rgba(0,0,0,.18);
      border-radius: 14px;
      pointer-events:none;
      mix-blend-mode:multiply;
    }

    /* Jagged manga cut (accent) */
    .manga-cut{
      position:relative;
      overflow:hidden;
    }
    .manga-cut::before{
      content:"";
      position:absolute;
      inset:-2px;
      pointer-events:none;
      background:
        linear-gradient(90deg, transparent 0 6px, rgba(0,0,0,.08) 6px 8px, transparent 8px 14px) 0 0/16px 100%;
      opacity:.25;
      mix-blend-mode:multiply;
      transform:skewX(-10deg);
    }

    /* Speech bubble */
    .bubble{
      position:relative;
      background:#fff;
      border:3px solid #000;
      border-radius:18px;
      padding:.6rem .8rem;
      box-shadow: var(--shadow, 3px 3px 0 #000);
    }
    .bubble:before{
      content:"";
      position:absolute;
      bottom:-14px;
      right:22px; /* RTL tail */
      width:0;height:0;
      border:12px solid transparent;
      border-top-color:#000;
      transform: rotate(8deg);
    }
    .bubble:after{
      content:"";
      position:absolute;
      bottom:-10px;
      right:24px;
      width:0;height:0;
      border:10px solid transparent;
      border-top-color:#fff;
      transform: rotate(8deg);
    }

    /* Inputs */
    .ink-input{
      background: rgba(255,255,255,.85);
      border:3px solid #000;
      border-radius: 14px;
      padding:.85rem 1rem;
      outline: none;
      box-shadow: 3px 3px 0 #000;
    }
    .ink-input:focus{
      box-shadow: 0 0 0 3px rgba(0,0,0,.22), 3px 3px 0 #000;
    }
    .ink-input.is-bad{ border-style: dashed; }
    .ink-input.is-good{ border-style: solid; }

    /* Buttons */
    .btn-ink{
      border:3px solid #000;
      border-radius: 14px;
      padding:.9rem 1rem;
      font-weight:800;
      box-shadow: 4px 4px 0 #000;
      transition: transform .08s ease, box-shadow .08s ease;
      user-select:none;
    }
    .btn-ink:active{
      transform: translate(2px,2px);
      box-shadow: 2px 2px 0 #000;
    }
    .btn-ink[disabled]{
      opacity:.55;
      cursor:not-allowed;
      filter: grayscale(1);
    }

    /* Chips as manga stickers */
    .sticker{
      border:3px solid #000;
      border-radius: 999px;
      padding:.55rem .85rem;
      box-shadow: 3px 3px 0 #000;
      background:#fff;
      position:relative;
      transition: transform .12s ease;
    }
    .sticker::after{
      content:"";
      position:absolute;
      inset:-10px;
      background:
        radial-gradient(circle at 8px 10px, rgba(0,0,0,.06) 2px, transparent 3px) 0 0/16px 16px;
      opacity:.35;
      z-index:-1;
      filter: blur(.2px);
    }
    .sticker[data-on="true"]{
      background:#000;
      color:#fff;
      transform: rotate(-1.2deg);
    }

    /* Progress: manga dividers */
    .divider{
      height:16px;
      border:3px solid #000;
      border-radius: 999px;
      overflow:hidden;
      background: rgba(255,255,255,.55);
      box-shadow: 3px 3px 0 #000;
    }
    .divider .fill{
      height:100%;
      width:0%;
      background: #000;
      background-image:
        radial-gradient(circle at 2px 2px, rgba(255,255,255,.20) 1px, transparent 2px);
      background-size: 10px 10px;
      transition: width .35s ease;
    }

    /* Page flip transition */
    @keyframes flipOut{
      0%{ transform: perspective(900px) rotateY(0deg) translateY(0); filter: blur(0); }
      100%{ transform: perspective(900px) rotateY(-80deg) translateY(4px); filter: blur(1.5px); opacity:.12; }
    }
    @keyframes flipIn{
      0%{ transform: perspective(900px) rotateY(80deg) translateY(4px); filter: blur(1.5px); opacity:.12; }
      100%{ transform: perspective(900px) rotateY(0deg) translateY(0); filter: blur(0); opacity:1; }
    }
    .flip-out{ animation: flipOut .28s ease forwards; transform-origin: right center; }
    .flip-in{ animation: flipIn .32s ease forwards; transform-origin: right center; }

    /* Stamp */
    @keyframes stampIn{
      0%{ transform: translate(-50%,-50%) scale(.2) rotate(-22deg); opacity:0; filter: blur(1px); }
      65%{ transform: translate(-50%,-50%) scale(1.12) rotate(-14deg); opacity:1; filter: blur(0); }
      100%{ transform: translate(-50%,-50%) scale(1) rotate(-14deg); opacity:1; }
    }
    .stamp{
      position:absolute;
      top:18%;
      left:14%;
      transform: translate(-50%,-50%) rotate(-14deg);
      border:5px solid #000;
      border-radius: 16px;
      padding:.55rem .75rem;
      font-weight:900;
      letter-spacing:.06em;
      background: rgba(255,255,255,.88);
      box-shadow: 5px 5px 0 #000;
      text-transform: uppercase;
      mix-blend-mode:multiply;
    }
    .stamp.live{ animation: stampIn .55s cubic-bezier(.2,1.2,.2,1) both; }

    /* Ink splash */
    @keyframes splash{
      0%{ transform: translate(-50%,-50%) scale(.2) rotate(0deg); opacity:0; }
      60%{ transform: translate(-50%,-50%) scale(1.05) rotate(10deg); opacity:.85; }
      100%{ transform: translate(-50%,-50%) scale(1.2) rotate(18deg); opacity:0; }
    }
    .ink-splash{
      position:fixed;
      top:18%;
      left:60%;
      width:160px;
      height:120px;
      pointer-events:none;
      opacity:0;
      z-index:50;
      transform: translate(-50%,-50%);
      filter: blur(.2px);
    }
    .ink-splash.show{ animation: splash .65s ease-out both; }
    .ink-splash svg{ width:100%; height:100%; }

    /* Follow stamp button */
    .follow-btn{
      position:relative;
      border:3px solid #000;
      border-radius: 14px;
      padding:.65rem .8rem;
      font-weight:900;
      box-shadow: 3px 3px 0 #000;
      background:#fff;
      overflow:hidden;
    }
    .follow-btn[data-on="true"]{
      background:#000;
      color:#fff;
    }
    .follow-btn .mini-stamp{
      position:absolute;
      inset:auto auto 8px 10px; /* left corner */
      transform: rotate(-18deg);
      border:3px solid currentColor;
      padding:.15rem .35rem;
      border-radius: 10px;
      font-size:.7rem;
      opacity:.0;
      background: rgba(255,255,255,.18);
      color: currentColor;
      mix-blend-mode: multiply;
    }
    .follow-btn.bam .mini-stamp{ opacity:1; animation: stampIn .5s cubic-bezier(.2,1.2,.2,1) both; }

    /* Avatar tile */
    .avatar-tile{
      border:3px solid #000;
      border-radius: 18px;
      background:#fff;
      box-shadow: 3px 3px 0 #000;
      padding:.65rem;
      display:flex;
      align-items:center;
      justify-content:center;
      aspect-ratio: 1/1;
      transition: transform .12s ease;
    }
    .avatar-tile[data-on="true"]{
      background:#000;
      color:#fff;
      transform: rotate(1deg);
    }

    /* Priority list */
    .prio-item{
      border:3px solid #000;
      border-radius: 14px;
      background:#fff;
      box-shadow: 3px 3px 0 #000;
      padding:.65rem .75rem;
      display:flex;
      align-items:center;
      gap:.5rem;
    }
    .handle{
      width:32px;height:32px;
      border:3px solid #000;
      border-radius: 12px;
      display:grid;
      place-items:center;
      box-shadow: 2px 2px 0 #000;
      background: rgba(0,0,0,.05);
      cursor:grab;
    }
    .handle:active{ cursor:grabbing; }
    .mini-btn{
      border:3px solid #000;
      border-radius: 12px;
      width:38px;height:38px;
      display:grid;
      place-items:center;
      box-shadow: 2px 2px 0 #000;
      background:#fff;
      font-weight:900;
    }
    .mini-btn:active{ transform: translate(1px,1px); box-shadow: 1px 1px 0 #000; }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      .flip-out,.flip-in{ animation:none !important; }
      .stamp.live,.ink-splash.show,.follow-btn.bam .mini-stamp{ animation:none !important; }
      .btn-ink,.sticker,.avatar-tile{ transition:none !important; }
    }
  </style>
</head>

<body class="paper">
  <!-- Ink splash -->
  <div id="inkSplash" class="ink-splash" aria-hidden="true">
    <svg viewBox="0 0 200 150" fill="none">
      <path d="M62 20c18-10 31 6 42 4 15-3 16-20 30-10 12 9 3 25 16 32 17 9 36-6 41 10 5 15-17 20-20 32-3 15 20 18 15 33-6 16-26 4-38 14-12 10 4 26-12 35-16 9-23-15-38-15-15 0-20 22-35 16-16-6-2-26-12-38-10-12-31 4-36-12-5-16 21-18 21-33 0-15-25-17-20-33 5-16 29-2 41-10 12-8-2-27 15-35Z" fill="#000" opacity=".92"/>
      <circle cx="22" cy="62" r="6" fill="#000" opacity=".92"/>
      <circle cx="176" cy="44" r="7" fill="#000" opacity=".92"/>
      <circle cx="160" cy="128" r="6" fill="#000" opacity=".92"/>
      <circle cx="44" cy="128" r="5" fill="#000" opacity=".92"/>
    </svg>
  </div>

  <main class="max-w-md mx-auto px-4 pt-5 pb-28">
    <!-- Header -->
    <header class="panel manga-cut p-4 shadow-ink">
      <div class="flex items-start gap-3">
        <div class="shrink-0 mt-1">
          <!-- line art icon -->
          <svg width="42" height="42" viewBox="0 0 48 48" fill="none" aria-hidden="true">
            <path d="M10 34c2 6 26 6 28 0" stroke="#000" stroke-width="3" stroke-linecap="round"/>
            <path d="M12 18c2-8 22-8 24 0" stroke="#000" stroke-width="3" stroke-linecap="round"/>
            <path d="M17 22v6" stroke="#000" stroke-width="3" stroke-linecap="round"/>
            <path d="M31 22v6" stroke="#000" stroke-width="3" stroke-linecap="round"/>
            <path d="M8 20c4-12 28-12 32 0" stroke="#000" stroke-width="3" stroke-linecap="round"/>
            <path d="M14 14c2-6 18-6 20 0" stroke="#000" stroke-width="3" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="grow">
          <div class="flex items-center justify-between gap-3">
            <h1 class="text-xl font-extrabold tracking-tight">ØªØ³Ø¬ÙŠÙ„ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</h1>
            <span class="text-xs font-extrabold border-2 border-black rounded-full px-3 py-1 bg-white shadow-inkSm">MANGA UI</span>
          </div>
          <div class="mt-3 bubble shadow-inkSm">
            <div class="font-bold">Ù‡Ù„Ø§! ğŸ‘‹</div>
            <div class="text-sm opacity-90">Ø³Ø¬Ù‘Ù„ Ø¨Ø®Ø·ÙˆØ§Øª Ø³Ø±ÙŠØ¹Ø©â€¦ ÙƒØ£Ù†Ù‡Ø§ ØµÙØ­Ø§Øª Ù…Ø§Ù†ØºØ§. âœ¦</div>
          </div>
        </div>
      </div>

      <!-- Progress -->
      <div class="mt-4">
        <div class="flex items-center justify-between gap-3">
          <div class="text-sm font-extrabold">
            Ø§Ù„Ø®Ø·ÙˆØ© <span id="stepNum">1</span> / <span>5</span>
          </div>
          <div class="text-xs font-bold opacity-80" id="stepLabel">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„</div>
        </div>
        <div class="mt-2 divider" aria-label="Ø´Ø±ÙŠØ· ØªÙ‚Ø¯Ù‘Ù…">
          <div id="progressFill" class="fill"></div>
        </div>

        <div class="mt-3 grid grid-cols-5 gap-2 text-[11px] font-extrabold opacity-90">
          <div class="text-center">Ù¡</div>
          <div class="text-center">Ù¢</div>
          <div class="text-center">Ù£</div>
          <div class="text-center">Ù¤</div>
          <div class="text-center">Ù¥</div>
        </div>
      </div>
    </header>

    <!-- Step Frame -->
    <section id="stepFrame" class="panel manga-cut mt-5 p-4 shadow-ink min-h-[520px]">
      <!-- Stamp overlay (generic) -->
      <div id="globalStamp" class="stamp hidden" aria-hidden="true">APPROVED</div>

      <!-- STEP 1 -->
      <div class="step" data-step="1">
        <div class="flex items-start justify-between gap-3">
          <h2 class="text-lg font-extrabold">Ù¡) Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h2>
          <span class="text-xs font-extrabold border-2 border-black rounded-full px-3 py-1 bg-white shadow-inkSm">LIVE</span>
        </div>
        <p class="mt-2 text-sm opacity-85">ØªØ­Ù‚Ù‘Ù‚ Ù„Ø­Ø¸ÙŠ ÙˆØ±Ø³Ø§Ø¦Ù„ Ø¯Ø§Ø®Ù„ Ø¨Ø§Ù„ÙˆÙ†Ø§Øª.</p>

        <div class="mt-4 space-y-4">
          <div>
            <label class="block text-sm font-bold mb-2">Ø§Ù„Ø§Ø³Ù…</label>
            <input id="name" class="ink-input w-full" placeholder="Ù…Ø«Ø§Ù„: dev.luffy" autocomplete="name" />
            <div class="mt-2 bubble hidden" id="nameBubble"></div>
          </div>

          <div>
            <label class="block text-sm font-bold mb-2">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
            <input id="email" class="ink-input w-full" placeholder="you@example.com" autocomplete="email" inputmode="email" />
            <div class="mt-2 bubble hidden" id="emailBubble"></div>
          </div>

          <div>
            <label class="block text-sm font-bold mb-2">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
            <input id="password" type="password" class="ink-input w-full" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="new-password" />
            <div class="mt-2 bubble hidden" id="passBubble"></div>
          </div>

          <div>
            <label class="block text-sm font-bold mb-2">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
            <input id="confirm" type="password" class="ink-input w-full" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="new-password" />
            <div class="mt-2 bubble hidden" id="confirmBubble"></div>
          </div>
        </div>

        <div class="mt-5 bubble shadow-inkSm">
          <div class="font-extrabold">Ù†ØµÙŠØ­Ø© Ù…Ø§Ù†ØºØ§ âœ¦</div>
          <div class="text-sm opacity-90">ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ù‚ÙˆÙŠØ© = ÙØµÙ„ Ø£ÙˆÙ„ Ù‚ÙˆÙŠ.</div>
        </div>
      </div>

      <!-- STEP 2 -->
      <div class="step hidden" data-step="2">
        <h2 class="text-lg font-extrabold">Ù¢) Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ø§Ù…Ø©</h2>
        <p class="mt-2 text-sm opacity-85">Ø®Ù„Ù‘Ù†Ø§ Ù†Ø¹Ø±ÙÙƒ Ø¨Ø³Ø±Ø¹Ø©.</p>

        <div class="mt-4 space-y-4">
          <div>
            <label class="block text-sm font-bold mb-2">Ù†Ø¨Ø°Ø© Ù‚ØµÙŠØ±Ø©</label>
            <textarea id="bio" class="ink-input w-full min-h-[120px] resize-none" placeholder="Ø§ÙƒØªØ¨ Ø³Ø·Ø±ÙŠÙ† Ø¹Ù†Ùƒâ€¦"></textarea>
          </div>

          <div>
            <label class="block text-sm font-bold mb-2">Ø§Ù„Ø¨Ù„Ø¯</label>
            <select id="country" class="ink-input w-full">
              <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¨Ù„Ø¯â€¦</option>
              <option>ÙÙ„Ø³Ø·ÙŠÙ†</option>
              <option>Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</option>
              <option>Ù…ØµØ±</option>
              <option>Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª</option>
              <option>Ø§Ù„Ø£Ø±Ø¯Ù†</option>
              <option>Ù„Ø¨Ù†Ø§Ù†</option>
              <option>Ø§Ù„Ù…ØºØ±Ø¨</option>
              <option>Ø§Ù„Ø¹Ø±Ø§Ù‚</option>
              <option>Ø³ÙˆØ±ÙŠØ§</option>
              <option>ØªÙˆÙ†Ø³</option>
              <option>Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±</option>
              <option>Ù‚Ø·Ø±</option>
              <option>Ø¹ÙÙ…Ø§Ù†</option>
              <option>Ø§Ù„ÙƒÙˆÙŠØª</option>
              <option>Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†</option>
              <option>Ø§Ù„ÙŠÙ…Ù†</option>
              <option>Ø£Ø®Ø±Ù‰</option>
            </select>
          </div>

          <div class="panel p-3 shadow-inkSm bg-white/60">
            <div class="text-sm font-extrabold mb-2">Ù†ÙˆØ¹ Ø§Ù„Ù‚Ø§Ø±Ø¦/Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯</div>
            <div class="grid grid-cols-1 gap-2">
              <label class="flex items-center gap-3 ink-input cursor-pointer">
                <input type="radio" name="rtype" value="Anime watcher" class="accent-black" />
                <span class="font-bold">Anime watcher</span>
              </label>
              <label class="flex items-center gap-3 ink-input cursor-pointer">
                <input type="radio" name="rtype" value="Manga reader" class="accent-black" />
                <span class="font-bold">Manga reader</span>
              </label>
              <label class="flex items-center gap-3 ink-input cursor-pointer">
                <input type="radio" name="rtype" value="Both" class="accent-black" />
                <span class="font-bold">Both</span>
              </label>
            </div>
          </div>
        </div>

        <div class="mt-5 bubble shadow-inkSm">
          <div class="font-extrabold">Ø¨Ø§Ù„ÙˆÙ† ØµØºÙŠØ± ğŸˆ</div>
          <div class="text-sm opacity-90">ØªÙ‚Ø¯Ø± ØªØºÙŠÙ‘Ø± ÙƒÙ„ Ø´ÙŠØ¡ Ù„Ø§Ø­Ù‚Ù‹Ø§ Ù…Ù† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª.</div>
        </div>
      </div>

      <!-- STEP 3 -->
      <div class="step hidden" data-step="3">
        <h2 class="text-lg font-extrabold">Ù£) ØµÙˆØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</h2>
        <p class="mt-2 text-sm opacity-85">Ø§Ø±ÙØ¹ ØµÙˆØ±Ø© Ø£Ùˆ Ø§Ø®ØªØ± Ø£ÙØ§ØªØ§Ø± â€œÙ…Ø§Ù†ØºØ§ Ø³ØªØ§ÙŠÙ„â€.</p>

        <div class="mt-4 grid grid-cols-1 gap-4">
          <div class="panel p-3 shadow-inkSm bg-white/60">
            <div class="flex items-center gap-3">
              <div class="w-16 h-16 rounded-2xl border-3 border-black shadow-inkSm overflow-hidden bg-white grid place-items-center" id="avatarPreview">
                <svg width="42" height="42" viewBox="0 0 48 48" fill="none" aria-hidden="true">
                  <path d="M12 36c3-8 21-8 24 0" stroke="#000" stroke-width="3" stroke-linecap="round"/>
                  <path d="M12 18c2-10 22-10 24 0" stroke="#000" stroke-width="3" stroke-linecap="round"/>
                  <path d="M18 22v6" stroke="#000" stroke-width="3" stroke-linecap="round"/>
                  <path d="M30 22v6" stroke="#000" stroke-width="3" stroke-linecap="round"/>
                </svg>
              </div>
              <div class="grow">
                <div class="font-extrabold">Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©</div>
                <div class="text-xs opacity-85">PNG/JPG â€” ÙŠÙØ¶Ù‘Ù„ Ù…Ø±Ø¨Ø¹.</div>
              </div>
            </div>

            <div class="mt-3">
              <label class="block text-sm font-bold mb-2">Ø±ÙØ¹ ØµÙˆØ±Ø©</label>
              <input id="avatarUpload" type="file" accept="image/*"
                     class="ink-input w-full cursor-pointer"
              />
              <div class="mt-2 bubble hidden" id="avatarBubble"></div>
            </div>
          </div>

          <div>
            <div class="flex items-center justify-between gap-3">
              <div class="font-extrabold">Ø£ÙØ§ØªØ§Ø±Ø§Øª Ù…Ø§Ù†ØºØ§ (Ø¹Ø§Ù…Ù‘Ø©)</div>
              <button id="clearAvatar" class="mini-btn" type="button" title="Ù…Ø³Ø­">Ã—</button>
            </div>
            <div id="avatarGrid" class="mt-3 grid grid-cols-4 gap-3"></div>

            <div class="mt-4 bubble shadow-inkSm">
              <div class="font-extrabold">ØªÙ„Ù…ÙŠØ­ âœ¦</div>
              <div class="text-sm opacity-90">Ø§Ø®ØªÙØ± Ø£ÙØ§ØªØ§Ø± ÙŠÙ„ÙŠÙ‚ Ø¨Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙØµÙ„ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ.</div>
            </div>
          </div>
        </div>
      </div>

      <!-- STEP 4 -->
      <div class="step hidden" data-step="4">
        <h2 class="text-lg font-extrabold">Ù¤) Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù…Ø´Ø§Ù‡ÙŠØ±</h2>
        <p class="mt-2 text-sm opacity-85">ÙƒØ±ÙˆØª Ø¯Ø§Ø®Ù„ Panels + Ø®ØªÙ… FOLLOW / FOLLOWING.</p>

        <div class="mt-4 panel p-3 shadow-inkSm bg-white/60">
          <label class="block text-sm font-bold mb-2">Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹</label>
          <div class="flex items-center gap-2">
            <input id="celebritySearch" class="ink-input w-full" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…â€¦" />
            <button id="clearSearch" class="mini-btn" type="button" title="Ù…Ø³Ø­">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M6 6l12 12M18 6L6 18" stroke="#000" stroke-width="3" stroke-linecap="round"/>
              </svg>
            </button>
          </div>
        </div>

        <div class="mt-4 bubble shadow-inkSm">
          <div class="font-extrabold">ğŸˆ</div>
          <div class="text-sm opacity-90">Ø§ØªØ¨Ø¹ Ø§Ù„Ù…Ø¨Ø¯Ø¹ÙŠÙ† Ø§Ù„Ù…ÙØ¶Ù„ÙŠÙ†â€¦ Ø£Ùˆ Ø§ØµÙ†Ø¹ Ù‚Ø§Ø¦Ù…ØªÙƒ Ù„Ø§Ø­Ù‚Ù‹Ø§.</div>
        </div>

        <div id="celebrityGrid" class="mt-4 grid grid-cols-1 gap-3"></div>
      </div>

      <!-- STEP 5 -->
      <div class="step hidden" data-step="5">
        <h2 class="text-lg font-extrabold">Ù¥) Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª ÙˆØ§Ù„ØªØµÙ†ÙŠÙØ§Øª</h2>
        <p class="mt-2 text-sm opacity-85">Chips Ø¯Ø§Ø®Ù„ â€œÙ…Ù„ØµÙ‚Ø§Øª Ù…Ø§Ù†ØºØ§â€ + ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª.</p>

        <div class="mt-4 panel p-3 shadow-inkSm bg-white/60">
          <div class="font-extrabold mb-3">Ø§Ø®ØªØ± Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª</div>
          <div id="chips" class="flex flex-wrap gap-2"></div>
        </div>

        <div class="mt-4 bubble shadow-inkSm">
          <div class="font-extrabold">ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© ğŸ¯</div>
          <div class="text-sm opacity-90">Ø§Ø³Ø­Ø¨/Ø£ÙÙ„Øª Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… â†‘ â†“ (Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù„). </div>
        </div>

        <div class="mt-4 panel p-3 shadow-inkSm bg-white/60">
          <div class="flex items-center justify-between">
            <div class="font-extrabold">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª</div>
            <div class="text-xs font-bold opacity-80"><span id="prioCount">0</span> Ù…Ø­Ø¯Ø¯</div>
          </div>
          <div id="prioList" class="mt-3 space-y-3"></div>
        </div>
      </div>

      <!-- SUCCESS -->
      <div class="step hidden" data-step="6">
        <div class="relative">
          <div class="stamp live" style="top:16%;left:16%;">APPROVED</div>
          <h2 class="text-xl font-extrabold mt-1">Ù„ÙˆØ­Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ© âœ¦</h2>
          <p class="mt-2 text-sm opacity-85">Welcome to the Community!</p>

          <div class="mt-4 panel p-3 shadow-inkSm bg-white/60">
            <div class="font-extrabold mb-3">Ù…Ù„Ø®Øµ Ø§Ø®ØªÙŠØ§Ø±Ø§ØªÙƒ</div>

            <div class="flex items-start gap-3">
              <div class="w-16 h-16 rounded-2xl border-3 border-black shadow-inkSm overflow-hidden bg-white grid place-items-center" id="summaryAvatar"></div>
              <div class="grow">
                <div class="text-sm font-extrabold" id="summaryName">â€”</div>
                <div class="text-xs opacity-85" id="summaryMeta">â€”</div>
              </div>
            </div>

            <div class="mt-4 grid grid-cols-1 gap-3">
              <div class="panel p-3 shadow-inkSm bg-white/70">
                <div class="font-extrabold">Following</div>
                <div id="summaryFollowing" class="mt-2 text-sm opacity-90"></div>
              </div>

              <div class="panel p-3 shadow-inkSm bg-white/70">
                <div class="font-extrabold">Interests (Priority)</div>
                <ol id="summaryInterests" class="mt-2 text-sm opacity-90 list-decimal pr-6"></ol>
              </div>
            </div>

            <div class="mt-4 bubble shadow-inkSm">
              <div class="font-extrabold">Ø¬Ø§Ù‡Ø²ØŸ âœ¦</div>
              <div class="text-sm opacity-90">Ø§Ø¶ØºØ· Ø²Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„â€¦ ÙˆÙ„Ù†Ø¨Ø¯Ø£ Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯.</div>
            </div>
          </div>

          <button id="ctaGo" class="btn-ink w-full mt-4 bg-black text-white">
            Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ù†ØµØ©
          </button>

          <button id="resetAll" class="btn-ink w-full mt-3 bg-white">
            Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø·
          </button>
        </div>
      </div>
    </section>
  </main>

  <!-- Bottom sticky actions -->
  <footer class="fixed bottom-0 left-0 right-0">
    <div class="max-w-md mx-auto px-4 pb-4">
      <div class="panel p-3 shadow-ink bg-white/80 backdrop-blur">
        <div class="flex items-center gap-2">
          <button id="prevBtn" class="btn-ink w-1/3 bg-white" type="button">
            Ø§Ù„Ø³Ø§Ø¨Ù‚
          </button>

          <button id="nextBtn" class="btn-ink w-2/3 bg-black text-white" type="button">
            Ø§Ù„ØªØ§Ù„ÙŠ
          </button>
        </div>

        <div class="mt-3 flex items-center justify-between text-xs font-extrabold opacity-85">
          <div class="flex items-center gap-2">
            <span class="inline-flex items-center gap-1">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M6 12h12" stroke="#000" stroke-width="3" stroke-linecap="round"/>
                <path d="M12 6l6 6-6 6" stroke="#000" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              ØµÙØ­Ø©
            </span>
            <span class="border-2 border-black rounded-full px-2 py-0.5 bg-white shadow-inkSm" id="pageTag">1</span>
          </div>
          <button id="saveHint" type="button" class="underline">Ø­ÙØ¸ Ù…Ø­Ù„ÙŠ</button>
        </div>
      </div>
    </div>
  </footer>

  <script>
    // ====== Data ======
    const LS_KEY = "manga_signup_state_v1";
    const stepsTotal = 5;

    const STEP_LABELS = {
      1: "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„",
      2: "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ø§Ù…Ø©",
      3: "Ø§Ù„ØµÙˆØ±Ø©",
      4: "Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©",
      5: "Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª",
      6: "Ø§Ù„Ù†Ø¬Ø§Ø­"
    };

    const INTERESTS = [
      "Shonen","Seinen","Isekai","Mecha","Slice of Life","Fantasy","Sci-Fi","Romance",
      "Horror","Sports","Mystery","Comedy","Drama","Gaming","Art","Cosplay"
    ];

    // Fictional / generic "celebs"
    const CELEBS = [
      { id:"c1", name:"Kaito Sensei", tag:"Ù…Ø¤Ù„Ù Ù…Ø§Ù†ØºØ§ â€” Ø­Ø¨ÙƒØ§Øª Ù…Ù„ØªÙˆÙŠØ©" },
      { id:"c2", name:"Rina Inks", tag:"Ø±Ø³Ø§Ù…Ø© â€” Ø­Ø¨Ø± + Ù‡Ø§ÙØªÙˆÙ†" },
      { id:"c3", name:"Studio NightFrame", tag:"Ø§Ø³ØªÙˆØ¯ÙŠÙˆ â€” Ø£ÙƒØ´Ù† Ø³ÙŠÙ†Ù…Ø§Ø¦ÙŠ" },
      { id:"c4", name:"Yoru Narrator", tag:"ÙƒØ§ØªØ¨ â€” Ø³Ù„Ø§ÙŠØ³ Ø£ÙˆÙ Ù„Ø§ÙŠÙ" },
      { id:"c5", name:"Mika Panelist", tag:"Ù…Ø±Ø§Ø¬Ø¹Ø§Øª â€” ØªÙˆØµÙŠØ§Øª Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©" },
      { id:"c6", name:"Dai ChibiLab", tag:"ÙÙ†Ø§Ù† â€” ØªØ´ÙŠØ¨ÙŠ Ù„Ø·ÙŠÙ" },
      { id:"c7", name:"Nova SFX", tag:"ØµÙˆØªÙŠØ§Øª â€” BOOM! KRAK!" },
      { id:"c8", name:"Atlas Lore", tag:"ØªØ­Ù„ÙŠÙ„ â€” Ø¹ÙˆØ§Ù„Ù… ÙˆÙ‚ØµØµ" },
    ];

    const AVATARS = [
      { id:"a1", svg: avatarSvg("HairSpike") },
      { id:"a2", svg: avatarSvg("Bangs") },
      { id:"a3", svg: avatarSvg("RoundGlasses") },
      { id:"a4", svg: avatarSvg("Mask") },
      { id:"a5", svg: avatarSvg("CatHood") },
      { id:"a6", svg: avatarSvg("Ribbon") },
      { id:"a7", svg: avatarSvg("Scar") },
      { id:"a8", svg: avatarSvg("Hood") },
    ];

    function avatarSvg(styleName){
      // Simple original line-art (public-domain-like primitives)
      const commonHead = `
        <rect x="6" y="6" width="36" height="36" rx="14" fill="white" stroke="currentColor" stroke-width="3"/>
        <path d="M14 30c3 8 17 8 20 0" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
        <path d="M16 20v6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
        <path d="M32 20v6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
      `;
      const styles = {
        HairSpike: `<path d="M10 18c4-10 24-10 28 0" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                    <path d="M14 14l4 5 3-7 3 7 4-5" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>`,
        Bangs: `<path d="M10 19c4-11 24-11 28 0" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                <path d="M14 16c3 3 6 4 10 0 4 4 7 3 10 0" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>`,
        RoundGlasses: `<path d="M10 18c4-10 24-10 28 0" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                       <circle cx="17" cy="24" r="5" stroke="currentColor" stroke-width="3" fill="none"/>
                       <circle cx="31" cy="24" r="5" stroke="currentColor" stroke-width="3" fill="none"/>
                       <path d="M22 24h4" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>`,
        Mask: `<path d="M10 18c4-10 24-10 28 0" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
               <path d="M13 24c5 6 17 6 22 0" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
               <path d="M12 26h24" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>`,
        CatHood: `<path d="M10 18c4-10 24-10 28 0" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                  <path d="M14 14l-2-5 6 3M34 14l2-5-6 3" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>`,
        Ribbon: `<path d="M10 18c4-10 24-10 28 0" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                 <path d="M24 12l-6 4 6 2 6-2-6-4Z" fill="none" stroke="currentColor" stroke-width="3" stroke-linejoin="round"/>`,
        Scar: `<path d="M10 18c4-10 24-10 28 0" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
               <path d="M27 18l-2 10" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>`,
        Hood: `<path d="M10 18c4-10 24-10 28 0" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
               <path d="M12 18c1 18 23 18 24 0" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
               <path d="M18 16c4 2 8 2 12 0" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>`,
      };

      return `
        <svg viewBox="0 0 48 48" width="48" height="48" fill="none" aria-hidden="true">
          <g color="currentColor">
            ${commonHead}
            ${styles[styleName] || ""}
          </g>
        </svg>
      `;
    }

    // ====== Elements ======
    const stepFrame = document.getElementById("stepFrame");
    const stepNumEl = document.getElementById("stepNum");
    const stepLabelEl = document.getElementById("stepLabel");
    const pageTag = document.getElementById("pageTag");
    const progressFill = document.getElementById("progressFill");

    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const saveHint = document.getElementById("saveHint");

    const inkSplash = document.getElementById("inkSplash");

    // Step 1 fields
    const nameEl = document.getElementById("name");
    const emailEl = document.getElementById("email");
    const passEl = document.getElementById("password");
    const confirmEl = document.getElementById("confirm");
    const nameBubble = document.getElementById("nameBubble");
    const emailBubble = document.getElementById("emailBubble");
    const passBubble = document.getElementById("passBubble");
    const confirmBubble = document.getElementById("confirmBubble");

    // Step 2 fields
    const bioEl = document.getElementById("bio");
    const countryEl = document.getElementById("country");

    // Step 3
    const avatarUpload = document.getElementById("avatarUpload");
    const avatarGrid = document.getElementById("avatarGrid");
    const avatarPreview = document.getElementById("avatarPreview");
    const avatarBubble = document.getElementById("avatarBubble");
    const clearAvatarBtn = document.getElementById("clearAvatar");

    // Step 4
    const celebritySearch = document.getElementById("celebritySearch");
    const clearSearch = document.getElementById("clearSearch");
    const celebrityGrid = document.getElementById("celebrityGrid");

    // Step 5
    const chipsEl = document.getElementById("chips");
    const prioList = document.getElementById("prioList");
    const prioCount = document.getElementById("prioCount");

    // Success
    const summaryAvatar = document.getElementById("summaryAvatar");
    const summaryName = document.getElementById("summaryName");
    const summaryMeta = document.getElementById("summaryMeta");
    const summaryFollowing = document.getElementById("summaryFollowing");
    const summaryInterests = document.getElementById("summaryInterests");
    const ctaGo = document.getElementById("ctaGo");
    const resetAll = document.getElementById("resetAll");

    // ====== State ======
    let state = {
      step: 1,
      name: "",
      email: "",
      password: "",
      bio: "",
      country: "",
      rtype: "",
      avatarMode: "none", // none | upload | preset
      avatarUploadData: "",
      avatarPresetId: "",
      following: [], // celeb ids
      interests: [], // ordered
    };

    // ====== Storage ======
    function saveState(){
      try{
        localStorage.setItem(LS_KEY, JSON.stringify(state));
        pulseInk();
      }catch(e){}
    }
    function loadState(){
      try{
        const raw = localStorage.getItem(LS_KEY);
        if(!raw) return;
        const parsed = JSON.parse(raw);
        if(parsed && typeof parsed === "object"){
          state = { ...state, ...parsed };
        }
      }catch(e){}
    }
    function clearState(){
      try{ localStorage.removeItem(LS_KEY); }catch(e){}
    }

    // ====== UI Helpers ======
    function showSplash(){
      inkSplash.classList.remove("show");
      // force reflow
      void inkSplash.offsetWidth;
      inkSplash.classList.add("show");
    }
    function pulseInk(){
      // small splash only sometimes (micro)
      if(Math.random() < 0.35) showSplash();
    }

    function setBubble(bubbleEl, text, ok=null){
      bubbleEl.textContent = text;
      bubbleEl.classList.remove("hidden");
      bubbleEl.style.borderStyle = (ok === false) ? "dashed" : "solid";
    }
    function hideBubble(bubbleEl){
      bubbleEl.classList.add("hidden");
      bubbleEl.textContent = "";
    }

    function setInputState(input, ok){
      input.classList.remove("is-good","is-bad");
      if(ok === true) input.classList.add("is-good");
      if(ok === false) input.classList.add("is-bad");
    }

    function progressPct(step){
      const s = Math.min(Math.max(step,1),stepsTotal);
      return ((s-1)/(stepsTotal-1))*100;
    }

    function updateHeader(){
      const s = state.step;
      const displayStep = (s<=5) ? s : 5;
      stepNumEl.textContent = displayStep;
      pageTag.textContent = displayStep;
      stepLabelEl.textContent = STEP_LABELS[s] || "";
      progressFill.style.width = progressPct(displayStep) + "%";

      prevBtn.style.display = (s===1 || s===6) ? "none" : "inline-flex";
      saveHint.style.display = (s===6) ? "none" : "inline-flex";

      if(s === 5){
        nextBtn.textContent = "Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨";
      }else if(s === 6){
        nextBtn.textContent = "ØªÙ…";
        nextBtn.disabled = true;
      }else{
        nextBtn.textContent = "Ø§Ù„ØªØ§Ù„ÙŠ";
      }
    }

    function showStep(step, animate=true){
      const current = stepFrame.querySelector('.step:not(.hidden)');
      const next = stepFrame.querySelector(`.step[data-step="${step}"]`);
      if(!next) return;

      const doSwap = () => {
        stepFrame.querySelectorAll(".step").forEach(el => el.classList.add("hidden"));
        next.classList.remove("hidden");
        state.step = step;
        updateHeader();
        hydrateStep();
        saveState();
      };

      if(!animate || !current){
        doSwap();
        return;
      }

      stepFrame.classList.remove("flip-in");
      stepFrame.classList.add("flip-out");
      stepFrame.addEventListener("animationend", function onOut(e){
        if(e.animationName !== "flipOut") return;
        stepFrame.removeEventListener("animationend", onOut);
        stepFrame.classList.remove("flip-out");
        doSwap();
        stepFrame.classList.add("flip-in");
        stepFrame.addEventListener("animationend", function onIn(e2){
          if(e2.animationName !== "flipIn") return;
          stepFrame.removeEventListener("animationend", onIn);
          stepFrame.classList.remove("flip-in");
        });
      });
    }

    function globalStamp(text){
      const el = document.getElementById("globalStamp");
      el.textContent = text || "STAMP";
      el.classList.remove("hidden");
      el.classList.remove("live");
      void el.offsetWidth;
      el.classList.add("live");
      setTimeout(()=>{ el.classList.add("hidden"); el.classList.remove("live"); }, 700);
    }

    // ====== Validation ======
    function isEmail(v){
      return /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i.test(String(v||"").trim());
    }
    function validateStep1(live=false){
      const name = nameEl.value.trim();
      const email = emailEl.value.trim();
      const pass = passEl.value;
      const conf = confirmEl.value;

      let ok = true;

      if(name.length < 3){
        ok = false;
        setInputState(nameEl,false);
        setBubble(nameBubble, "Ø§Ù„Ø§Ø³Ù… Ù„Ø§Ø²Ù… ÙŠÙƒÙˆÙ† Ù£ Ø£Ø­Ø±Ù Ø£Ùˆ Ø£ÙƒØ«Ø±.", false);
      }else{
        setInputState(nameEl,true);
        setBubble(nameBubble, "ØªÙ…Ø§Ù…! Ø§Ø³Ù…Ùƒ Ø¬Ø§Ù‡Ø² Ù„Ù„Ù…Ø§Ù†ØºØ§. âœ“", true);
      }

      if(!isEmail(email)){
        ok = false;
        setInputState(emailEl,false);
        setBubble(emailBubble, "Ø§ÙƒØªØ¨ Ø¨Ø±ÙŠØ¯ ØµØ­ÙŠØ­ (Ù…Ø«Ø§Ù„: you@domain.com).", false);
      }else{
        setInputState(emailEl,true);
        setBubble(emailBubble, "Ø¨Ø±ÙŠØ¯ Ù…Ø¶Ø¨ÙˆØ·. âœ“", true);
      }

      const passStrong = pass.length >= 8 && /[A-Za-z]/.test(pass) && /\d/.test(pass);
      if(!passStrong){
        ok = false;
        setInputState(passEl,false);
        setBubble(passBubble, "Ø®Ù„ÙŠÙ‡Ø§ Ù¨+ Ø£Ø­Ø±Ù + Ø±Ù‚Ù… ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.", false);
      }else{
        setInputState(passEl,true);
        setBubble(passBubble, "Ù‚ÙˆÙŠØ©! BOOM! âœ“", true);
      }

      if(conf.length === 0 && live){
        setInputState(confirmEl,null);
        hideBubble(confirmBubble);
      }else if(conf !== pass || conf.length === 0){
        ok = false;
        setInputState(confirmEl,false);
        setBubble(confirmBubble, "Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ù„Ø§Ø²Ù… ÙŠØ·Ø§Ø¨Ù‚ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±.", false);
      }else{
        setInputState(confirmEl,true);
        setBubble(confirmBubble, "Ù…Ø·Ø§Ø¨Ù‚! âœ“", true);
      }

      // store
      state.name = name;
      state.email = email;
      state.password = pass;

      return ok;
    }

    function validateStep2(){
      state.bio = bioEl.value.trim();
      state.country = countryEl.value;
      const r = document.querySelector('input[name="rtype"]:checked');
      state.rtype = r ? r.value : "";

      // allow empty bio, but require country + rtype
      if(!state.country || !state.rtype){
        showSplash();
        globalStamp("CHECK");
        return false;
      }
      return true;
    }

    function validateStep3(){
      // optional but recommend something
      const hasUpload = !!state.avatarUploadData;
      const hasPreset = !!state.avatarPresetId;
      if(!hasUpload && !hasPreset){
        setBubble(avatarBubble, "Ø§Ø®ØªÙØ± Ø£ÙØ§ØªØ§Ø± Ø£Ùˆ Ø§Ø±ÙØ¹ ØµÙˆØ±Ø© (Ø¹Ø´Ø§Ù† Ù†ÙƒÙ…Ù‘Ù„!).", false);
        showSplash();
        return false;
      }
      hideBubble(avatarBubble);
      return true;
    }

    function validateStep4(){
      // allow zero following, but confirm via stamp
      return true;
    }

    function validateStep5(){
      // require at least 2 interests for better personalization
      if((state.interests||[]).length < 2){
        showSplash();
        globalStamp("MORE!");
        return false;
      }
      return true;
    }

    // ====== Render / Hydrate ======
    function hydrateStep(){
      // sync common ui based on state.step
      if(state.step === 1){
        nameEl.value = state.name || "";
        emailEl.value = state.email || "";
        passEl.value = state.password || "";
        confirmEl.value = (state.password && state.password === confirmEl.value) ? confirmEl.value : confirmEl.value;

        // only show bubbles if any input
        if(nameEl.value || emailEl.value || passEl.value || confirmEl.value){
          validateStep1(true);
        }else{
          hideBubble(nameBubble); hideBubble(emailBubble); hideBubble(passBubble); hideBubble(confirmBubble);
          setInputState(nameEl,null); setInputState(emailEl,null); setInputState(passEl,null); setInputState(confirmEl,null);
        }
      }

      if(state.step === 2){
        bioEl.value = state.bio || "";
        countryEl.value = state.country || "";
        if(state.rtype){
          const r = document.querySelector(`input[name="rtype"][value="${cssEscape(state.rtype)}"]`);
          if(r) r.checked = true;
        }
      }

      if(state.step === 3){
        renderAvatarGrid();
        renderAvatarPreview();
        if(state.avatarMode === "none"){
          hideBubble(avatarBubble);
        }
      }

      if(state.step === 4){
        renderCelebs();
      }

      if(state.step === 5){
        renderChips();
        renderPrio();
      }

      if(state.step === 6){
        renderSummary();
      }
    }

    function cssEscape(str){
      // minimal escape for attribute selector
      return String(str).replace(/"/g,'\\"');
    }

    // ====== Avatars ======
    function renderAvatarGrid(){
      avatarGrid.innerHTML = "";
      AVATARS.forEach(a=>{
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "avatar-tile";
        btn.setAttribute("data-id", a.id);
        btn.setAttribute("data-on", state.avatarPresetId === a.id ? "true" : "false");
        btn.innerHTML = `<div class="text-black ${state.avatarPresetId === a.id ? "text-white" : ""}">${a.svg}</div>`;
        btn.addEventListener("click", ()=>{
          state.avatarMode = "preset";
          state.avatarPresetId = a.id;
          state.avatarUploadData = "";
          avatarUpload.value = "";
          hideBubble(avatarBubble);
          renderAvatarGrid();
          renderAvatarPreview();
          globalStamp("OK");
          saveState();
        });
        avatarGrid.appendChild(btn);
      });
    }

    function renderAvatarPreview(){
      avatarPreview.innerHTML = "";
      if(state.avatarUploadData){
        const img = new Image();
        img.src = state.avatarUploadData;
        img.alt = "ØµÙˆØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…";
        img.className = "w-full h-full object-cover";
        avatarPreview.appendChild(img);
        return;
      }
      if(state.avatarPresetId){
        const found = AVATARS.find(a=>a.id === state.avatarPresetId);
        if(found){
          const wrap = document.createElement("div");
          wrap.className = "text-black";
          wrap.innerHTML = found.svg;
          avatarPreview.appendChild(wrap);
          return;
        }
      }
      avatarPreview.innerHTML = `
        <svg width="42" height="42" viewBox="0 0 48 48" fill="none" aria-hidden="true">
          <path d="M12 36c3-8 21-8 24 0" stroke="#000" stroke-width="3" stroke-linecap="round"/>
          <path d="M12 18c2-10 22-10 24 0" stroke="#000" stroke-width="3" stroke-linecap="round"/>
          <path d="M18 22v6" stroke="#000" stroke-width="3" stroke-linecap="round"/>
          <path d="M30 22v6" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        </svg>
      `;
    }

    avatarUpload.addEventListener("change", (e)=>{
      const f = e.target.files && e.target.files[0];
      if(!f) return;
      if(!f.type.startsWith("image/")){
        setBubble(avatarBubble, "Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ù…Ø´ ØµÙˆØ±Ø©.", false);
        return;
      }
      const reader = new FileReader();
      reader.onload = () => {
        state.avatarMode = "upload";
        state.avatarUploadData = reader.result;
        state.avatarPresetId = "";
        renderAvatarGrid();
        renderAvatarPreview();
        setBubble(avatarBubble, "ØªÙ… Ø§Ù„Ø±ÙØ¹! âœ“", true);
        showSplash();
        saveState();
      };
      reader.readAsDataURL(f);
    });

    clearAvatarBtn.addEventListener("click", ()=>{
      state.avatarMode = "none";
      state.avatarUploadData = "";
      state.avatarPresetId = "";
      avatarUpload.value = "";
      renderAvatarGrid();
      renderAvatarPreview();
      setBubble(avatarBubble, "ØªÙ… Ù…Ø³Ø­ Ø§Ù„ØµÙˆØ±Ø©/Ø§Ù„Ø£ÙØ§ØªØ§Ø±.", true);
      saveState();
    });

    // ====== Celebs ======
    function renderCelebs(){
      celebrityGrid.innerHTML = "";
      const q = (celebritySearch.value || "").trim().toLowerCase();
      const list = CELEBS.filter(c => !q || c.name.toLowerCase().includes(q) || c.tag.toLowerCase().includes(q));

      list.forEach(c=>{
        const isOn = (state.following || []).includes(c.id);

        const card = document.createElement("div");
        card.className = "panel p-3 shadow-inkSm bg-white/65";
        card.innerHTML = `
          <div class="flex items-start justify-between gap-3">
            <div class="min-w-0">
              <div class="font-extrabold truncate">${escapeHtml(c.name)}</div>
              <div class="text-xs opacity-85 mt-1">${escapeHtml(c.tag)}</div>
            </div>
            <button type="button" class="follow-btn shrink-0" data-id="${c.id}" data-on="${isOn ? "true":"false"}">
              <span class="label">${isOn ? "FOLLOWING":"FOLLOW"}</span>
              <span class="mini-stamp">${isOn ? "OK" : "!"}</span>
            </button>
          </div>
        `;
        const btn = card.querySelector(".follow-btn");
        btn.addEventListener("click", ()=>{
          const id = c.id;
          const idx = state.following.indexOf(id);
          if(idx >= 0){
            state.following.splice(idx,1);
          }else{
            state.following.push(id);
          }
          btn.classList.remove("bam");
          void btn.offsetWidth;
          btn.classList.add("bam");
          showSplash();
          saveState();
          renderCelebs(); // refresh labels
        });

        celebrityGrid.appendChild(card);
      });

      if(list.length === 0){
        const empty = document.createElement("div");
        empty.className = "bubble shadow-inkSm";
        empty.textContent = "Ù…Ø§ ÙÙŠ Ù†ØªØ§Ø¦Ø¬â€¦ Ø¬Ø±Ù‘Ø¨ ÙƒÙ„Ù…Ø© Ø«Ø§Ù†ÙŠØ©.";
        celebrityGrid.appendChild(empty);
      }
    }

    celebritySearch.addEventListener("input", ()=>{
      renderCelebs();
      saveState();
    });
    clearSearch.addEventListener("click", ()=>{
      celebritySearch.value = "";
      renderCelebs();
      celebritySearch.focus();
    });

    // ====== Interests ======
    function renderChips(){
      chipsEl.innerHTML = "";
      INTERESTS.forEach(label=>{
        const on = (state.interests || []).includes(label);
        const chip = document.createElement("button");
        chip.type = "button";
        chip.className = "sticker text-sm font-extrabold";
        chip.setAttribute("data-on", on ? "true" : "false");
        chip.textContent = label;
        chip.addEventListener("click", ()=>{
          toggleInterest(label);
        });
        chipsEl.appendChild(chip);
      });
      prioCount.textContent = (state.interests || []).length;
    }

    function toggleInterest(label){
      state.interests = state.interests || [];
      const idx = state.interests.indexOf(label);
      if(idx >= 0){
        state.interests.splice(idx,1);
      }else{
        state.interests.push(label);
      }
      showSplash();
      saveState();
      renderChips();
      renderPrio();
    }

    function renderPrio(){
      prioList.innerHTML = "";
      const arr = state.interests || [];
      prioCount.textContent = arr.length;

      if(arr.length === 0){
        const note = document.createElement("div");
        note.className = "bubble shadow-inkSm";
        note.textContent = "Ø§Ø®ØªØ± Ø§Ù‡ØªÙ…Ø§Ù…Ù‹Ø§ Ø£Ùˆ Ø§Ø«Ù†ÙŠÙ†â€¦ Ø«Ù… Ø±ØªÙ‘Ø¨Ù‡Ù….";
        prioList.appendChild(note);
        return;
      }

      arr.forEach((label, i)=>{
        const item = document.createElement("div");
        item.className = "prio-item";
        item.draggable = true;
        item.setAttribute("data-index", String(i));
        item.innerHTML = `
          <div class="handle" title="Ø³Ø­Ø¨">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M8 7h8M8 12h8M8 17h8" stroke="#000" stroke-width="3" stroke-linecap="round"/>
            </svg>
          </div>
          <div class="grow min-w-0">
            <div class="font-extrabold truncate">${escapeHtml(label)}</div>
            <div class="text-[11px] opacity-70 font-bold">Ø£ÙˆÙ„ÙˆÙŠØ© #${i+1}</div>
          </div>
          <button type="button" class="mini-btn" data-act="up" aria-label="Ø£Ø¹Ù„Ù‰">â†‘</button>
          <button type="button" class="mini-btn" data-act="down" aria-label="Ø£Ø³ÙÙ„">â†“</button>
          <button type="button" class="mini-btn" data-act="remove" aria-label="Ø­Ø°Ù">Ã—</button>
        `;

        item.querySelectorAll(".mini-btn").forEach(btn=>{
          btn.addEventListener("click", ()=>{
            const act = btn.getAttribute("data-act");
            if(act === "up") moveInterest(i, i-1);
            if(act === "down") moveInterest(i, i+1);
            if(act === "remove") toggleInterest(label);
          });
        });

        // Drag & drop
        item.addEventListener("dragstart", (e)=>{
          e.dataTransfer.setData("text/plain", String(i));
          e.dataTransfer.effectAllowed = "move";
          item.style.opacity = ".6";
        });
        item.addEventListener("dragend", ()=>{
          item.style.opacity = "1";
        });
        item.addEventListener("dragover", (e)=>{
          e.preventDefault();
          e.dataTransfer.dropEffect = "move";
        });
        item.addEventListener("drop", (e)=>{
          e.preventDefault();
          const from = Number(e.dataTransfer.getData("text/plain"));
          const to = i;
          if(Number.isFinite(from) && from !== to){
            moveInterest(from, to);
          }
        });

        prioList.appendChild(item);
      });
    }

    function moveInterest(from, to){
      const arr = state.interests || [];
      if(from < 0 || from >= arr.length) return;
      if(to < 0 || to >= arr.length) return;
      const [it] = arr.splice(from,1);
      arr.splice(to,0,it);
      state.interests = arr;
      globalStamp("SWAP");
      saveState();
      renderChips();
      renderPrio();
    }

    // ====== Summary ======
    function renderSummary(){
      summaryName.textContent = state.name ? state.name : "â€”";
      const meta = [
        state.country ? `ğŸ“ ${state.country}` : "ğŸ“ â€”",
        state.rtype ? `âœ¨ ${state.rtype}` : "âœ¨ â€”"
      ].join(" â€¢ ");
      summaryMeta.textContent = meta;

      // Avatar
      summaryAvatar.innerHTML = "";
      if(state.avatarUploadData){
        const img = new Image();
        img.src = state.avatarUploadData;
        img.alt = "Avatar";
        img.className = "w-full h-full object-cover";
        summaryAvatar.appendChild(img);
      }else if(state.avatarPresetId){
        const found = AVATARS.find(a=>a.id === state.avatarPresetId);
        summaryAvatar.innerHTML = found ? `<div class="text-black">${found.svg}</div>` : "";
      }else{
        summaryAvatar.innerHTML = `
          <svg width="42" height="42" viewBox="0 0 48 48" fill="none" aria-hidden="true">
            <path d="M12 36c3-8 21-8 24 0" stroke="#000" stroke-width="3" stroke-linecap="round"/>
            <path d="M12 18c2-10 22-10 24 0" stroke="#000" stroke-width="3" stroke-linecap="round"/>
            <path d="M18 22v6" stroke="#000" stroke-width="3" stroke-linecap="round"/>
            <path d="M30 22v6" stroke="#000" stroke-width="3" stroke-linecap="round"/>
          </svg>
        `;
      }

      // Following
      const names = (state.following || [])
        .map(id => (CELEBS.find(c=>c.id===id) || {}).name)
        .filter(Boolean);

      summaryFollowing.textContent = names.length ? names.join(" â€¢ ") : "â€” Ù…Ø§ Ø§Ø®ØªØ±Øª Ø£Ø­Ø¯ (Ø¹Ø§Ø¯ÙŠ!)";

      // Interests
      summaryInterests.innerHTML = "";
      (state.interests || []).forEach(it=>{
        const li = document.createElement("li");
        li.textContent = it;
        summaryInterests.appendChild(li);
      });

      showSplash();
    }

    // ====== Events ======
    function escapeHtml(s){
      return String(s).replace(/[&<>"']/g, (c)=>({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
      }[c]));
    }

    // Live validation
    [nameEl, emailEl, passEl, confirmEl].forEach(el=>{
      el.addEventListener("input", ()=>{
        validateStep1(true);
        saveState();
      });
      el.addEventListener("blur", ()=>{
        validateStep1(true);
        saveState();
      });
    });

    // Step2 sync
    bioEl.addEventListener("input", ()=>{ state.bio = bioEl.value.trim(); saveState(); });
    countryEl.addEventListener("change", ()=>{ state.country = countryEl.value; saveState(); });
    document.querySelectorAll('input[name="rtype"]').forEach(r=>{
      r.addEventListener("change", ()=>{
        state.rtype = r.value;
        globalStamp("OK");
        saveState();
      });
    });

    // Navigation buttons
    prevBtn.addEventListener("click", ()=>{
      if(state.step <= 1 || state.step === 6) return;
      showStep(state.step - 1, true);
    });

    nextBtn.addEventListener("click", ()=>{
      if(state.step === 6) return;

      // validate current step
      if(state.step === 1){
        if(!validateStep1(false)){
          showSplash();
          globalStamp("CHECK");
          return;
        }
      }
      if(state.step === 2){
        if(!validateStep2()) return;
      }
      if(state.step === 3){
        if(!validateStep3()) return;
      }
      if(state.step === 4){
        if(!validateStep4()) return;
      }
      if(state.step === 5){
        if(!validateStep5()) return;
        // SUCCESS
        showSplash();
        globalStamp("STAMP");
        setTimeout(()=>showStep(6,true), 60);
        return;
      }

      showStep(state.step + 1, true);
    });

    saveHint.addEventListener("click", ()=>{
      saveState();
      globalStamp("SAVE");
    });

    ctaGo.addEventListener("click", ()=>{
      showSplash();
      globalStamp("GO!");
      // Demo CTA
      alert("âœ… ØªÙ…! (CTA ØªØ¬Ø±ÙŠØ¨ÙŠ) â€” Ø§Ø±Ø¨Ø·Ù‡Ø§ Ø¨ØµÙØ­ØªÙƒ/Next.js route.");
    });

    resetAll.addEventListener("click", ()=>{
      if(!confirm("Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø·ØŸ")) return;
      clearState();
      state = {
        step: 1,
        name: "",
        email: "",
        password: "",
        bio: "",
        country: "",
        rtype: "",
        avatarMode: "none",
        avatarUploadData: "",
        avatarPresetId: "",
        following: [],
        interests: [],
      };
      // reset UI
      nameEl.value = ""; emailEl.value=""; passEl.value=""; confirmEl.value="";
      bioEl.value=""; countryEl.value=""; celebritySearch.value=""; avatarUpload.value="";
      hideBubble(nameBubble); hideBubble(emailBubble); hideBubble(passBubble); hideBubble(confirmBubble); hideBubble(avatarBubble);
      setInputState(nameEl,null); setInputState(emailEl,null); setInputState(passEl,null); setInputState(confirmEl,null);
      document.querySelectorAll('input[name="rtype"]').forEach(r=>r.checked=false);
      renderAvatarGrid(); renderAvatarPreview();
      renderCelebs(); renderChips(); renderPrio();
      showStep(1,false);
      globalStamp("RESET");
      showSplash();
    });

    // ====== Init ======
    function init(){
      loadState();

      // Render static lists
      renderAvatarGrid();
      renderChips();

      // Apply loaded values
      nameEl.value = state.name || "";
      emailEl.value = state.email || "";
      passEl.value = state.password || "";
      bioEl.value = state.bio || "";
      countryEl.value = state.country || "";

      if(state.rtype){
        const r = document.querySelector(`input[name="rtype"][value="${cssEscape(state.rtype)}"]`);
        if(r) r.checked = true;
      }

      // Ensure step bounds
      if(!Number.isFinite(state.step) || state.step < 1) state.step = 1;
      if(state.step > 6) state.step = 6;

      // Show initial step
      showStep(state.step, false);

      // Initial renders
      renderAvatarPreview();
      renderCelebs();
      renderPrio();

      // If there is any content in step1, validate to show bubbles
      if(nameEl.value || emailEl.value || passEl.value || confirmEl.value){
        validateStep1(true);
      }
    }

    init();
  </script>
</body>
</html>
