<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>3</title>
  <style>
    :root{
      --bg1:#fff1f7;
      --bg2:#eef7ff;
      --ink:#1c2133;
      --muted:#4b5777;
      --glass: rgba(255,255,255,.55);
      --line: rgba(28,33,51,.14);
      --pink:#ff6fb1;
      --lav:#9b8cff;
      --mint:#66e6d6;
      --radius: 22px;
      --shadow: 0 22px 60px rgba(28,33,51,.18);
    }
    *{box-sizing:border-box;}
    html,body{height:100%;}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:var(--ink);
      background:
        radial-gradient(900px 600px at 20% 10%, rgba(255,111,177,.35), transparent 60%),
        radial-gradient(900px 600px at 80% 20%, rgba(155,140,255,.30), transparent 62%),
        radial-gradient(1000px 700px at 60% 95%, rgba(102,230,214,.20), transparent 62%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
    }

    /* floating petals */
    .petals{
      position:fixed; inset:0; pointer-events:none; opacity:.55;
      background-image:
        radial-gradient(circle at 20% 10%, rgba(255,111,177,.35) 0 2px, transparent 3px),
        radial-gradient(circle at 70% 35%, rgba(155,140,255,.30) 0 2px, transparent 3px),
        radial-gradient(circle at 40% 80%, rgba(102,230,214,.25) 0 2px, transparent 3px);
      background-size: 220px 220px, 260px 260px, 240px 240px;
      animation: drift 10s ease-in-out infinite;
      filter: blur(.2px);
    }
    @keyframes drift{
      0%,100%{ transform: translateY(0px); }
      50%{ transform: translateY(-14px); }
    }

    .wrap{ min-height:100%; display:grid; place-items:center; padding:28px; }
    .card{
      width:min(920px, 100%);
      background: var(--glass);
      border: 1px solid rgba(255,255,255,.7);
      border-radius: 26px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
      overflow:hidden;
      position:relative;
    }
    .card::before{
      content:"";
      position:absolute; inset:-2px;
      background: linear-gradient(90deg, rgba(255,111,177,.25), rgba(155,140,255,.18), rgba(102,230,214,.18));
      filter: blur(22px);
      opacity:.5;
      pointer-events:none;
    }
    header{
      position:relative; z-index:1;
      padding:20px 20px 16px;
      display:flex; gap:14px; align-items:center;
      border-bottom: 1px solid rgba(28,33,51,.08);
    }
    .avatarMain{
      width:84px;height:84px;border-radius:24px; overflow:hidden;
      border:2px solid rgba(255,255,255,.85);
      background: rgba(255,255,255,.35);
      box-shadow: 0 16px 36px rgba(28,33,51,.18);
      transition: transform .2s ease, box-shadow .2s ease;
    }
    .avatarMain:hover{
      transform: translateY(-2px) rotate(-.5deg);
      box-shadow: 0 20px 44px rgba(28,33,51,.22);
    }
    .avatarMain img{width:100%;height:100%;object-fit:cover;display:block;}

    .meta h1{ margin:0 0 6px; font-size:16px; letter-spacing:.2px; }
    .meta p{ margin:0; font-size:13px; color:var(--muted); }

    .btnRow{ margin-left:auto; display:flex; gap:10px; }
    .btn{
      border:1px solid var(--line);
      background: rgba(255,255,255,.5);
      color:var(--ink);
      padding:10px 12px;
      border-radius: 16px;
      cursor:pointer;
      font-weight:800;
      font-size:13px;
      transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
      display:inline-flex; gap:8px; align-items:center;
    }
    .btn:hover{
      transform: translateY(-2px);
      box-shadow: 0 16px 30px rgba(28,33,51,.14);
      border-color: rgba(255,111,177,.45);
    }
    .btn:active{ transform: translateY(0) scale(.98); }
    .btnPrimary{
      border-color: rgba(255,111,177,.55);
      background: rgba(255,111,177,.16);
    }
    .btn:focus-visible{
      outline:none;
      box-shadow: 0 0 0 3px rgba(155,140,255,.22);
    }

    .body{ position:relative; z-index:1; padding:16px 20px 22px; }
    .info{
      background: rgba(255,255,255,.45);
      border: 1px dashed rgba(28,33,51,.16);
      border-radius: 18px;
      padding:12px 14px;
      color: var(--muted);
      font-size:13px;
      line-height:1.45;
    }

    /* ===== Modal ===== */
    .modalRoot[aria-hidden="true"]{ display:none; }
    .overlay{
      position:fixed; inset:0;
      background: rgba(28,33,51,.32);
      backdrop-filter: blur(10px);
      display:grid; place-items:center;
      padding:24px;
      animation: overlayIn .16s ease-out;
    }
    @keyframes overlayIn{ from{opacity:0} to{opacity:1} }

    .modal{
      width:min(980px, 100%);
      background: rgba(255,255,255,.62);
      border: 1px solid rgba(255,255,255,.80);
      border-radius: 26px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      overflow:hidden;
      transform-origin: 50% 55%;
      animation: bloom .42s cubic-bezier(.2,1.15,.25,1);
      position:relative;
    }
    @keyframes bloom{
      0%{ transform: translateY(14px) scale(.92); opacity:0; }
      65%{ opacity:1; }
      100%{ transform: translateY(0) scale(1); opacity:1; }
    }
    .modal.closing{ animation: fadeDown .16s ease-in forwards; }
    @keyframes fadeDown{ to{ transform: translateY(10px) scale(.97); opacity:0; } }

    .modalTop{
      padding:16px 18px;
      display:flex; align-items:center; gap:10px;
      border-bottom: 1px solid rgba(28,33,51,.08);
    }
    .modalTop h2{ margin:0; font-size:16px; }
    .pill{
      font-size:11px;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(255,111,177,.35);
      background: rgba(255,111,177,.14);
      color: rgba(28,33,51,.80);
      font-weight:800;
    }
    .x{
      margin-left:auto;
      width:42px; height:42px;
      border-radius: 16px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.55);
      cursor:pointer;
      transition: transform .16s ease, box-shadow .16s ease;
    }
    .x:hover{ transform: translateY(-1px); box-shadow: 0 14px 24px rgba(28,33,51,.14); }
    .x:active{ transform: scale(.98); }
    .x:focus-visible{ outline:none; box-shadow: 0 0 0 3px rgba(255,111,177,.25); }

    .modalBody{
      padding:16px 18px 18px;
      display:grid;
      grid-template-columns: 320px 1fr;
      gap:14px;
    }

    .panel{
      background: rgba(255,255,255,.50);
      border: 1px solid rgba(28,33,51,.10);
      border-radius: 22px;
      padding:14px;
    }

    .previewWrap{
      display:grid; place-items:center; gap:12px;
    }
    .previewFrame{
      width:176px; height:176px;
      border-radius: 34px;
      overflow:hidden;
      border: 2px solid rgba(255,255,255,.9);
      box-shadow: 0 20px 44px rgba(28,33,51,.18);
      position:relative;
      animation: float 4.2s ease-in-out infinite;
      transition: transform .18s ease, box-shadow .18s ease;
      background: rgba(255,255,255,.35);
    }
    @keyframes float{
      0%,100%{ transform: translateY(0px); }
      50%{ transform: translateY(-8px); }
    }
    .previewFrame:hover{ box-shadow: 0 26px 56px rgba(28,33,51,.20); }

    .previewFrame img{ width:100%; height:100%; object-fit:cover; display:block; }

    /* border styles */
    .b-clean{ border-color: rgba(255,255,255,.9); }
    .b-sakura{
      border-color: rgba(255,111,177,.70);
      box-shadow: 0 0 0 4px rgba(255,111,177,.14), 0 20px 44px rgba(28,33,51,.18);
    }
    .b-gold{
      border-color: rgba(255,199,99,.85);
      box-shadow: 0 0 0 4px rgba(255,199,99,.18), 0 20px 44px rgba(28,33,51,.18);
    }
    .b-brush{
      border-width: 4px;
      border-style: solid;
      border-color: rgba(155,140,255,.70);
      outline: 2px dashed rgba(28,33,51,.12);
      outline-offset: 6px;
    }
    .b-mint{
      border-color: rgba(102,230,214,.80);
      box-shadow: 0 0 0 4px rgba(102,230,214,.18), 0 20px 44px rgba(28,33,51,.18);
    }

    .file{
      position:relative;
      overflow:hidden;
    }
    .file input{
      position:absolute; inset:0; opacity:0; cursor:pointer;
    }

    .gallery{
      display:grid;
      grid-template-columns: repeat(6, minmax(0, 1fr));
      gap:10px;
    }
    .thumb{
      aspect-ratio:1/1;
      border-radius: 18px;
      overflow:hidden;
      border: 1px solid rgba(28,33,51,.14);
      background: rgba(255,255,255,.5);
      cursor:pointer;
      transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
      position:relative;
    }
    .thumb img{ width:100%; height:100%; object-fit:cover; display:block; }
    .thumb:hover{
      transform: translateY(-3px) rotate(.4deg);
      border-color: rgba(155,140,255,.45);
      box-shadow: 0 14px 26px rgba(28,33,51,.14);
    }
    .thumb[aria-pressed="true"]{
      border-color: rgba(255,111,177,.65);
      box-shadow: 0 0 0 3px rgba(255,111,177,.18);
    }

    .chips{ display:flex; flex-wrap:wrap; gap:10px; }
    .chip{
      border: 1px solid rgba(28,33,51,.14);
      background: rgba(255,255,255,.55);
      padding:10px 12px;
      border-radius:999px;
      cursor:pointer;
      font-weight:900;
      font-size:12px;
      transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
      user-select:none;
    }
    .chip:hover{
      transform: translateY(-2px);
      border-color: rgba(102,230,214,.5);
      box-shadow: 0 14px 24px rgba(28,33,51,.12);
    }
    .chip[aria-pressed="true"]{
      border-color: rgba(155,140,255,.6);
      box-shadow: 0 0 0 3px rgba(155,140,255,.18);
    }

    .footer{
      padding:14px 18px 18px;
      display:flex; justify-content:flex-end; gap:10px;
      border-top: 1px solid rgba(28,33,51,.08);
    }

    @media (max-width: 860px){
      .modalBody{ grid-template-columns: 1fr; }
      .gallery{ grid-template-columns: repeat(3, minmax(0, 1fr)); }
    }
    @media (prefers-reduced-motion: reduce){
      *{ animation-duration:0.001ms!important; animation-iteration-count:1!important; transition-duration:0.001ms!important; }
    }
  </style>
</head>
<body>
  <div class="petals"></div>

  <main class="wrap">
    <section class="card">
      <header>
        <div class="avatarMain" id="avatarMain">
          <img id="avatarMainImg" alt="Your avatar"/>
        </div>
        <div class="meta">
          <h1>@luffy_dev Â· Follow Platform</h1>
          <p>Soft anime glass modal + smooth hover + focus trap.</p>
        </div>
        <div class="btnRow">
          <button class="btn btnPrimary" id="open">ðŸŒ¸ Choose Avatar</button>
          <button class="btn" type="button">Follow</button>
        </div>
      </header>
      <div class="body">
        <div class="info">
          Upload your avatar (demo preview) or pick one from the gallery.
          Then choose a border style and save.
        </div>
      </div>
    </section>
  </main>

  <div class="modalRoot" id="root" aria-hidden="true">
    <div class="overlay" id="overlay">
      <div class="modal" id="modal" role="dialog" aria-modal="true" aria-labelledby="title">
        <div class="modalTop">
          <h2 id="title">Sakura Avatar Studio</h2>
          <span class="pill">PASTEL GLASS</span>
          <button class="x" id="x" aria-label="Close">âœ•</button>
        </div>

        <div class="modalBody">
          <div class="panel">
            <div class="previewWrap">
              <div class="previewFrame b-sakura" id="frame">
                <img id="preview" alt="Avatar preview">
              </div>
              <div style="display:flex;gap:10px;flex-wrap:wrap;justify-content:center">
                <button class="btn file" type="button">ðŸ“¤ Upload
                  <input id="file" type="file" accept="image/*">
                </button>
                <button class="btn" id="random" type="button">ðŸŽ² Random</button>
              </div>
              <div style="font-size:12px;color:var(--muted);text-align:center;line-height:1.35">
                ESC closes Â· Tab stays inside modal Â· overlay click closes
              </div>
            </div>
          </div>

          <div style="display:grid;gap:12px;min-width:0">
            <div class="panel">
              <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
                <strong style="font-size:13px">Demo avatars</strong>
                <span style="font-size:12px;color:var(--muted)">hover tilt âœ¨</span>
              </div>
              <div class="gallery" id="gallery"></div>
            </div>

            <div class="panel">
              <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
                <strong style="font-size:13px">Border style</strong>
                <span style="font-size:12px;color:var(--muted)">focus ring</span>
              </div>
              <div class="chips" id="chips"></div>
            </div>
          </div>
        </div>

        <div class="footer">
          <button class="btn" id="cancel" type="button">Cancel</button>
          <button class="btn btnPrimary" id="save" type="button">Save</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    function svgData(svg){ return "data:image/svg+xml;charset=utf-8," + encodeURIComponent(svg.trim()); }

    const demo = [
      svgData(`<svg xmlns="http://www.w3.org/2000/svg" width="256" height="256">
        <defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
          <stop offset="0" stop-color="#ff6fb1"/><stop offset="1" stop-color="#9b8cff"/>
        </linearGradient></defs>
        <rect width="256" height="256" rx="40" fill="#ffffff"/>
        <circle cx="128" cy="132" r="82" fill="url(#g)" opacity=".22"/>
        <circle cx="128" cy="136" r="62" fill="#f5f6ff"/>
        <path d="M72 118c12-40 42-58 56-58s44 18 56 58" fill="none" stroke="#ff6fb1" stroke-width="12" stroke-linecap="round" opacity=".9"/>
        <circle cx="108" cy="140" r="9" fill="#1c2133"/><circle cx="148" cy="140" r="9" fill="#1c2133"/>
        <path d="M112 170c10 8 22 8 32 0" fill="none" stroke="#1c2133" stroke-width="8" stroke-linecap="round" opacity=".75"/>
      </svg>`),
      svgData(`<svg xmlns="http://www.w3.org/2000/svg" width="256" height="256">
        <rect width="256" height="256" rx="40" fill="#ffffff"/>
        <circle cx="128" cy="128" r="92" fill="#66e6d6" opacity=".18"/>
        <circle cx="128" cy="136" r="62" fill="#f7fbff"/>
        <path d="M82 112c18-22 34-30 46-30s28 8 46 30" fill="none" stroke="#9b8cff" stroke-width="12" stroke-linecap="round" opacity=".85"/>
        <path d="M96 144h28M132 144h28" stroke="#1c2133" stroke-width="10" stroke-linecap="round" opacity=".7"/>
        <path d="M112 170c10 4 22 4 32 0" fill="none" stroke="#ff6fb1" stroke-width="8" stroke-linecap="round" opacity=".8"/>
      </svg>`),
      svgData(`<svg xmlns="http://www.w3.org/2000/svg" width="256" height="256">
        <rect width="256" height="256" rx="40" fill="#ffffff"/>
        <path d="M0 176C54 130 84 210 128 168s74-32 128 8v80H0z" fill="#ff6fb1" opacity=".14"/>
        <circle cx="128" cy="136" r="62" fill="#f5f6ff"/>
        <path d="M72 120c10-30 36-50 56-50s46 20 56 50" fill="none" stroke="#66e6d6" stroke-width="12" stroke-linecap="round" opacity=".85"/>
        <circle cx="108" cy="142" r="8" fill="#1c2133"/><circle cx="148" cy="142" r="8" fill="#1c2133"/>
        <path d="M110 170c12 10 24 10 36 0" fill="none" stroke="#9b8cff" stroke-width="8" stroke-linecap="round" opacity=".75"/>
      </svg>`),
      svgData(`<svg xmlns="http://www.w3.org/2000/svg" width="256" height="256">
        <rect width="256" height="256" rx="40" fill="#ffffff"/>
        <circle cx="128" cy="128" r="92" fill="#9b8cff" opacity=".18"/>
        <circle cx="128" cy="136" r="62" fill="#f7fbff"/>
        <path d="M76 112c18-26 38-36 52-36s34 10 52 36" fill="none" stroke="#ff6fb1" stroke-width="12" stroke-linecap="round" opacity=".85"/>
        <path d="M96 142c10-10 18-10 28 0M132 142c10-10 18-10 28 0" stroke="#1c2133" stroke-width="8" stroke-linecap="round" opacity=".75"/>
        <path d="M112 170c10 6 22 6 32 0" fill="none" stroke="#1c2133" stroke-width="8" stroke-linecap="round" opacity=".55"/>
      </svg>`)
    ];

    const borders = [
      { cls:"b-clean", label:"Clean" },
      { cls:"b-sakura", label:"Sakura" },
      { cls:"b-gold", label:"Gold" },
      { cls:"b-brush", label:"Brush" },
      { cls:"b-mint", label:"Mint" },
    ];

    const openBtn = document.getElementById("open");
    const root = document.getElementById("root");
    const overlay = document.getElementById("overlay");
    const modal = document.getElementById("modal");
    const x = document.getElementById("x");
    const cancel = document.getElementById("cancel");
    const save = document.getElementById("save");

    const frame = document.getElementById("frame");
    const preview = document.getElementById("preview");
    const file = document.getElementById("file");
    const random = document.getElementById("random");

    const gallery = document.getElementById("gallery");
    const chips = document.getElementById("chips");

    const avatarMain = document.getElementById("avatarMain");
    const avatarMainImg = document.getElementById("avatarMainImg");

    let selectedSrc = demo[0];
    let selectedBorder = "b-sakura";
    let lastActive = null;

    function setPreview(src){
      selectedSrc = src;
      preview.src = src;
    }
    function setThumbPressed(src){
      [...gallery.querySelectorAll(".thumb")].forEach(b=>{
        b.setAttribute("aria-pressed", b.dataset.src === src ? "true" : "false");
      });
    }
    function applyBorder(cls){
      borders.forEach(b => frame.classList.remove(b.cls));
      frame.classList.add(cls);
      selectedBorder = cls;

      [...chips.querySelectorAll(".chip")].forEach(c=>{
        c.setAttribute("aria-pressed", c.dataset.border === cls ? "true" : "false");
      });
    }

    demo.forEach((src, i) => {
      const b = document.createElement("button");
      b.className = "thumb";
      b.type = "button";
      b.dataset.src = src;
      b.setAttribute("aria-pressed", i===0 ? "true" : "false");
      b.innerHTML = `<img alt="Demo avatar ${i+1}" src="${src}">`;
      b.addEventListener("click", () => { setPreview(src); setThumbPressed(src); });
      gallery.appendChild(b);
    });

    borders.forEach(b => {
      const c = document.createElement("button");
      c.className = "chip";
      c.type = "button";
      c.textContent = b.label;
      c.dataset.border = b.cls;
      c.setAttribute("aria-pressed", b.cls === selectedBorder ? "true" : "false");
      c.addEventListener("click", () => applyBorder(b.cls));
      chips.appendChild(c);
    });

    file.addEventListener("change", (e) => {
      const f = e.target.files && e.target.files[0];
      if(!f || !f.type.startsWith("image/")) return;
      const r = new FileReader();
      r.onload = () => { setPreview(r.result); setThumbPressed(""); };
      r.readAsDataURL(f);
      file.value = "";
    });

    random.addEventListener("click", () => {
      const idx = Math.floor(Math.random() * demo.length);
      setPreview(demo[idx]);
      setThumbPressed(demo[idx]);
    });

    function getFocusable(root){
      return [...root.querySelectorAll(
        'button,[href],input,select,textarea,[tabindex]:not([tabindex="-1"])'
      )].filter(el => !el.disabled && el.offsetParent !== null);
    }
    function onKeydown(e){
      if(e.key === "Escape"){ e.preventDefault(); closeModal(); return; }
      if(e.key === "Tab"){
        const f = getFocusable(modal);
        if(!f.length) return;
        const first = f[0], last = f[f.length-1];
        if(e.shiftKey && document.activeElement === first){ e.preventDefault(); last.focus(); }
        else if(!e.shiftKey && document.activeElement === last){ e.preventDefault(); first.focus(); }
      }
    }
    function openModal(){
      lastActive = document.activeElement;
      root.setAttribute("aria-hidden","false");
      modal.classList.remove("closing");
      setPreview(selectedSrc);
      applyBorder(selectedBorder);
      (getFocusable(modal)[0] || modal).focus();
      document.addEventListener("keydown", onKeydown);
    }
    function closeModal(){
      modal.classList.add("closing");
      document.removeEventListener("keydown", onKeydown);
      modal.addEventListener("animationend", function handler(){
        modal.removeEventListener("animationend", handler);
        root.setAttribute("aria-hidden","true");
        modal.classList.remove("closing");
        lastActive && lastActive.focus && lastActive.focus();
      }, { once:true });
    }

    overlay.addEventListener("mousedown", (e) => { if(e.target === overlay) closeModal(); });
    openBtn.addEventListener("click", openModal);
    x.addEventListener("click", closeModal);
    cancel.addEventListener("click", closeModal);

    save.addEventListener("click", () => {
      avatarMainImg.src = selectedSrc;
      borders.forEach(b => avatarMain.classList.remove(b.cls));
      avatarMain.classList.add(selectedBorder);
      closeModal();
    });

    // init
    avatarMainImg.src = selectedSrc;
    borders.forEach(b => avatarMain.classList.remove(b.cls));
    avatarMain.classList.add(selectedBorder);
    setPreview(selectedSrc);
    applyBorder(selectedBorder);
  </script>
</body>
</html>
